package com.carrot.beans;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

import javax.naming.NamingException;

import jsp.util.DBConnection;

public class ShoesDAO {
	
	private static ShoesDAO instance;
	
	
	public static ShoesDAO getInstance() {
		if(instance== null) {
			instance = new ShoesDAO();
		}
		return instance;
	}
	
	
	public ShoesVO[] getShoesList() throws SQLException,NamingException,ClassNotFoundException {
		
		ShoesVO[] list = new ShoesVO();
		
		StringBuffer sql= new StringBuffer();
		sql.append("select * from shoes");
		Connection conn = null;
		PreparedStatement pstmt = null;
		ResultSet rs = null;
		int i =0;
		try {
			conn = DBConnection.getConnection();
			conn.setAutoCommit(false);
			pstmt = (PreparedStatement)conn.prepareStatement(sql.toString());
			rs =pstmt.executeQuery();
			
			while(rs.next()) {
				ShoesVO vo = new ShoesVO();
				vo.setShoes_id(rs.getInt("shoes_id"));
				vo.setName(rs.getString("name"));
				vo.setPrice(rs.getString("price"));
				vo.setType(rs.getString("type"));
				vo.setImg(rs.getString("img"));
				list[i++] = vo;
			}
		}catch(NamingException | SQLException sqle) {
			System.out.println(sqle);
			
		}finally {
			try {
				if(pstmt!= null) {pstmt.close(); pstmt = null;}
				if(conn!=null) {conn.close(); conn = null;}
				if(rs!=null) {rs.close(); rs =null;}
			}catch(Exception e) {
				throw new RuntimeException(e.getMessage());
			}
		}
		
		
		
		return list; 
	}
	
	
}
